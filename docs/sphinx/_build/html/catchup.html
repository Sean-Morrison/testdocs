<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Running a BOSS DRP Daily Run" href="daily.html" /><link rel="prev" title="IDLspec2D: The SDSS BOSS Data Reduction Pipeline" href="intro.html" />

    <link rel="shortcut icon" href="_static/favicon_sdssv.ico"/><!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Running a BOSS DRP Catchup Run - IDLSPEC2D&#39;s Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=99aaee5e" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">IDLSPEC2D's Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/sdssv_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">IDLSPEC2D's Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">IDLspec2D: The SDSS BOSS Data Reduction Pipeline</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Running the BOSS DRP Catchup</a></li>
<li class="toctree-l1"><a class="reference internal" href="daily.html">Running the BOSS DRP Daily</a></li>
<li class="toctree-l1"><a class="reference internal" href="sos.html">Son-of-spectro (SOS): The BOSS on Mountain Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dependencies.html">Pipeline Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.html">Full Command Documention</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="running-a-boss-drp-catchup-run">
<h1>Running a BOSS DRP Catchup Run<a class="headerlink" href="#running-a-boss-drp-catchup-run" title="Permalink to this heading">#</a></h1>
<section id="daily-coadds">
<h2>Daily Coadds<a class="headerlink" href="#daily-coadds" title="Permalink to this heading">#</a></h2>
<section id="build-the-spplan-files">
<h3>build the spplan files<a class="headerlink" href="#build-the-spplan-files" title="Permalink to this heading">#</a></h3>
<p>The BOSS pipeline operation centers on a set of plan files built with the command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>spplan --topdir $BOSS_SPECTRO_REDUX --run2d $RUN2D --sdssv --no_dither --mjdend 60130 --log DR19_plans.log
spplan --topdir $BOSS_SPECTRO_REDUX --run2d $RUN2D --sdssv --no_dither --lco --mjdstart 60000 --mjdend 60280 --log IPL4-lco_plans.log
spplan --topdir $BOSS_SPECTRO_REDUX --run2d $RUN2D --sdssv --no_dither --mjdstart 60130 --mjdend 60280 --log IPL4-apo_plans.log
</pre></div>
</div>
</section>
<section id="build-fibermap-files-optional-but-recommended">
<h3>build fibermap files (<em>optional but recommended</em>)<a class="headerlink" href="#build-fibermap-files-optional-but-recommended" title="Permalink to this heading">#</a></h3>
<p>During observations confSummary (FPS) or plPlugMapM (plates) files are created that map the targets to the BOSS spectrograph fibers. This step (<a class="reference internal" href="doc.html#readfibermaps"><span class="std std-ref">readfibermaps</span></a>; <a class="reference internal" href="doc.html#slurm-readfibermap"><span class="std std-ref">slurm_readfibermap</span></a>) reads the two types of files, converts them to a uniform format, and adds additional meta data (either from files or the SDSS5 internal database). If this step is skipped then they will be built with redux from uubatchpbs, but due to db connection limits it works better to prerun them.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if you are rerunning the pipeline of released data, you are encouraged to download the spfibermap files from the released data as this step uses the internal SDSSV Database.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>slurm_readfibermap --topdir $BOSS_SPECTRO_REDUX --run2d $RUN2D --ppn 32
slurm_readfibermap --topdir $BOSS_SPECTRO_REDUX --run2d $RUN2D --ppn 32
</pre></div>
</div>
</section>
<section id="build-sptracetab-files">
<h3>build spTraceTab files<a class="headerlink" href="#build-sptracetab-files" title="Permalink to this heading">#</a></h3>
<p>In the FPS operations era of SDSSV, a large emphasis was put on minimizing overheads. As part of this effort, the number of calibration frames has been reduced. In order to ensure proper tracing of the spectra, in light of observered flexure, the arc frames taken with each field are correlated with the arcs taken concurrently with trace flats at the start of evening observations. This step (<a class="reference internal" href="doc.html#slurm-sptrace"><span class="std std-ref">slurm_spTrace</span></a>) builds plan files of the calibration frames, traces the flat, and then builds the trace table (spTraceTab) files that are used by the pipelines inplace of the raw flat traces.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>slurm_spTrace --topdir $BOSS_SPECTRO_REDUX --run2d $RUN2D --mjdstart 60130 --mjdend 60280 --clobber
slurm_spTrace --topdir $BOSS_SPECTRO_REDUX --run2d $RUN2D --mjdstart 60130 --mjdend 60280 --lco
</pre></div>
</div>
</section>
<section id="run-daily-coadd">
<h3>Run Daily Coadd<a class="headerlink" href="#run-daily-coadd" title="Permalink to this heading">#</a></h3>
<p>This step (<a class="reference internal" href="doc.html#uubatchpbs"><span class="std std-ref">uubatchpbs</span></a>) takes the plan files built by <a class="reference internal" href="doc.html#spplan"><span class="std std-ref">spplan</span></a> and builds the redux-field-mjd script files. It then (if running at Utah) submits these redux-field-mjd scripts to the slurm queue. These scripts produce all of the field-mjd files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">obs</span> <span class="n">apo</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span> <span class="o">--</span><span class="n">nodes</span> <span class="mi">7</span> <span class="o">--</span><span class="n">ppn</span> <span class="mi">64</span> <span class="o">--</span><span class="n">dr19</span>
<span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">obs</span> <span class="n">lco</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span> <span class="o">--</span><span class="n">nodes</span> <span class="mi">3</span> <span class="o">--</span><span class="n">ppn</span> <span class="mi">64</span> <span class="o">--</span><span class="n">merge3d</span>
</pre></div>
</div>
</section>
<section id="build-daily-summary-files">
<h3>Build Daily Summary Files<a class="headerlink" href="#build-daily-summary-files" title="Permalink to this heading">#</a></h3>
<p>The final step of the pipeline is to take the individual field-mjd summary files and merge them in to final summary files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slurm_pySummary</span> <span class="o">--</span><span class="n">module</span> <span class="n">bhm</span><span class="o">/</span><span class="n">v6_2_0beta</span> <span class="o">--</span><span class="n">full</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="field-epoch-coadds">
<h2>Field Epoch Coadds<a class="headerlink" href="#field-epoch-coadds" title="Permalink to this heading">#</a></h2>
<section id="id1">
<h3>build the spplan files<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>Due to the nature of scheduling, weather, and engineering constraints, epochs are often split over several nights. In plate operations the epochs were typically defined by a single plugging of plate (with some additional constrains for specialed fields such as the RM fields). In the FPS operations, the epochs have a much more complicated defintion that rely on the cadences defined in the SDSSV internal database, where an epoch is defined by a set of designs with a defined maximum length between the first and last design. This step (<a class="reference internal" href="doc.html#spplan-epoch"><span class="std std-ref">spplan_epoch</span></a>) determines the exposures within an epoch and builds a plan file detailing the exposures to combine.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are rerunning the pipeline of released data, you are encouraged to download the spPlancombepoch files from the released data as this step uses the internal SDSSV Database.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spplan_epoch</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">mod</span> <span class="n">bhm</span><span class="o">/</span><span class="n">v6_2_0beta</span> <span class="o">--</span><span class="n">started</span> <span class="o">--</span><span class="n">abandoned</span> <span class="o">--</span><span class="n">logfile</span> <span class="n">apo_epoch_60130</span><span class="o">.</span><span class="n">log</span> <span class="o">--</span><span class="n">apo</span> <span class="o">--</span><span class="n">clobber</span>
<span class="n">spplan_epoch</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">mod</span> <span class="n">bhm</span><span class="o">/</span><span class="n">v6_2_0beta</span> <span class="o">--</span><span class="n">abandoned</span> <span class="o">--</span><span class="n">logfile</span> <span class="n">lco_epoch_60280</span><span class="o">.</span><span class="n">log</span> <span class="o">--</span><span class="n">lco</span>
<span class="n">spplan_epoch</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">mod</span> <span class="n">bhm</span><span class="o">/</span><span class="n">v6_2_0beta</span> <span class="o">--</span><span class="n">abandoned</span> <span class="o">--</span><span class="n">logfile</span> <span class="n">apo_epoch_60280</span><span class="o">.</span><span class="n">log</span> <span class="o">--</span><span class="n">apo</span>
</pre></div>
</div>
</section>
<section id="run-the-epoch-coadd">
<h3>Run the epoch Coadd<a class="headerlink" href="#run-the-epoch-coadd" title="Permalink to this heading">#</a></h3>
<p>This step (<a class="reference internal" href="doc.html#uubatchpbs"><span class="std std-ref">uubatchpbs</span></a>) takes the plan files built by <a class="reference internal" href="doc.html#spplan-epoch"><span class="std std-ref">spplan_epoch</span></a> and builds the redux-field-mjd script files. It then (if running at Utah) submits these redux-field-mjd scripts to the slurm queue. These scripts produce all of the field-mjd files. The biggest difference between this and the daily version, is that the epoch redux scripts skip the initial extraction and calibration of the individual frames and uses those produced by the daily reduction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span> <span class="o">--</span><span class="n">epoch</span> <span class="o">--</span><span class="n">obs</span> <span class="n">apo</span>  <span class="o">--</span><span class="n">nodes</span> <span class="mi">5</span> <span class="o">--</span><span class="n">ppn</span> <span class="mi">64</span> <span class="o">--</span><span class="n">dr19</span>
<span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span> <span class="o">--</span><span class="n">epoch</span> <span class="o">--</span><span class="n">obs</span> <span class="n">lco</span>  <span class="o">--</span><span class="n">nodes</span> <span class="mi">3</span> <span class="o">--</span><span class="n">ppn</span> <span class="mi">64</span>
<span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span> <span class="o">--</span><span class="n">epoch</span> <span class="o">--</span><span class="n">obs</span> <span class="n">apo</span>  <span class="o">--</span><span class="n">nodes</span> <span class="mi">3</span> <span class="o">--</span><span class="n">ppn</span> <span class="mi">64</span>
</pre></div>
</div>
</section>
<section id="build-epoch-summary-files">
<h3>Build Epoch Summary Files<a class="headerlink" href="#build-epoch-summary-files" title="Permalink to this heading">#</a></h3>
<p>The final step of the epoch pipeline is to take the individual field-mjd epoch summary files and merge them in to final summary files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slurm_pySummary</span> <span class="o">--</span><span class="n">module</span> <span class="n">bhm</span><span class="o">/</span><span class="n">v6_2_0beta</span> <span class="o">--</span><span class="n">full</span> <span class="o">--</span><span class="n">epoch</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="custom-coadds-eg-allepoch">
<h2>Custom Coadds (eg. “allepoch”)<a class="headerlink" href="#custom-coadds-eg-allepoch" title="Permalink to this heading">#</a></h2>
<p>In SDSSV the variety of science programs (often sharing the same designs) required the development of an addition type of coadded spectra. In DR18 (v6_0_4), an early implementation of this was produced for the eFeds plates, where all of these plates, irregardless of the field centers and mjd were coadded together by running them through the full pipeline. In v6_1_1+ this strategy received a significant overhaul. Instead of reprocessing full plates from the start, we focus the effort on individual targets matching certain criteria and use the intermediate daily <em>spSpec</em> files (which includes the coadds of each each target on an exposure level) and produces an analogous to the spField files called spFullsky (because the original fields are not maintained). These files are then run through the 1d analysis and post production steps.</p>
<section id="managing-the-schema">
<h3>Managing the schema<a class="headerlink" href="#managing-the-schema" title="Permalink to this heading">#</a></h3>
<p>This step (<a class="reference internal" href="doc.html#manage-coadd-schema"><span class="std std-ref">manage_coadd_Schema</span></a>) is to build the coadd schema model for the custom coadds.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">manage_coadd_Schema</span> <span class="o">--</span><span class="n">name</span> <span class="n">allepoch</span> <span class="o">--</span><span class="n">DR</span>  <span class="o">-</span><span class="n">r</span>  <span class="o">-</span><span class="n">c</span>  <span class="s1">&#39;*spiders*&#39;</span> <span class="s1">&#39;*bhm_gua*&#39;</span> <span class="s1">&#39;*bhm_csc*&#39;</span> <span class="s1">&#39;*mwm_erosita*&#39;</span> <span class="s1">&#39;*bhm_colr_galaxies*&#39;</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>build the spplan files<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>Due to the nature of the FPS field designs, and the different requirements of different science programs, some coadding is needed on a target level.  This step (<a class="reference internal" href="doc.html#spplan-target"><span class="std std-ref">spplan_target</span></a>) uses the daily run summary file to determine the field and mjds of all observations of the selected targets, with the targets and cadences defined by the schema files (see <a class="reference internal" href="doc.html#manage-coadd-schema"><span class="std std-ref">manage_coadd_Schema</span></a>). It then builds the a target level plan file. The coadded “MJD” is defined as the final observed MJD of each target and targets with the same “MJD” are grouped together for processing and analysis. If a “MJD” has less then 10 targets, they are grouped with the next largest MJD for operational efficiency.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spplan_target</span> <span class="o">--</span><span class="n">batch</span> <span class="o">--</span><span class="n">DR</span> <span class="o">--</span><span class="n">logfile</span> <span class="n">apo_target_coadd_60130</span><span class="o">.</span><span class="n">log</span>
<span class="n">spplan_target</span> <span class="o">--</span><span class="n">batch</span> <span class="o">--</span><span class="n">DR</span> <span class="o">--</span><span class="n">logfile</span> <span class="n">lco_target_coadd_60280</span><span class="o">.</span><span class="n">log</span> <span class="o">--</span><span class="n">lco</span>
<span class="n">spplan_target</span> <span class="o">--</span><span class="n">batch</span> <span class="o">--</span><span class="n">DR</span> <span class="o">--</span><span class="n">logfile</span> <span class="n">apo_target_coadd_60280</span><span class="o">.</span><span class="n">log</span> <span class="o">--</span><span class="n">apo</span> <span class="o">--</span><span class="n">coadd_mjdstart</span> <span class="mi">60131</span>
</pre></div>
</div>
</section>
<section id="build-the-spfullsky-files">
<h3>Build the spFullSky files<a class="headerlink" href="#build-the-spfullsky-files" title="Permalink to this heading">#</a></h3>
<p>This step (<a class="reference internal" href="doc.html#uubatchpbs"><span class="std std-ref">uubatchpbs</span></a>), similarly to the daily and epoch coadds, produces the redux script files and runs them. However, for the Custom Coadds, it initially only produces the spFullSky files, with the remaining steps run in the next step.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">obs</span> <span class="n">apo</span> <span class="o">--</span><span class="n">nodes</span> <span class="mi">1</span> <span class="o">--</span><span class="n">custom</span> <span class="n">allepoch</span> <span class="o">--</span><span class="n">allsky</span> <span class="o">--</span><span class="n">coadd_only</span> <span class="o">--</span><span class="n">clobber</span> <span class="o">--</span><span class="n">dr19</span>
<span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">obs</span> <span class="n">lco</span> <span class="o">--</span><span class="n">nodes</span> <span class="mi">1</span> <span class="o">--</span><span class="n">custom</span> <span class="n">allepoch_lco</span> <span class="o">--</span><span class="n">allsky</span> <span class="o">--</span><span class="n">coadd_only</span>
<span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">obs</span> <span class="n">apo</span> <span class="o">--</span><span class="n">nodes</span> <span class="mi">1</span> <span class="o">--</span><span class="n">custom</span> <span class="n">allepoch</span> <span class="o">--</span><span class="n">allsky</span> <span class="o">--</span><span class="n">coadd_only</span>
</pre></div>
</div>
</section>
<section id="run-1d-analysis-and-post-processing-steps">
<h3>run 1d analysis and post processing steps<a class="headerlink" href="#run-1d-analysis-and-post-processing-steps" title="Permalink to this heading">#</a></h3>
<p>This step (<a class="reference internal" href="doc.html#uubatchpbs"><span class="std std-ref">uubatchpbs</span></a>), produces the redux script files and runs them for the 1D analysis and post processing steps.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">obs</span> <span class="n">apo</span> <span class="o">--</span><span class="n">nodes</span> <span class="mi">3</span> <span class="o">--</span><span class="n">custom</span> <span class="n">allepoch</span> <span class="o">--</span><span class="n">allsky</span> <span class="o">--</span><span class="mi">1</span><span class="n">dpost</span> <span class="o">--</span><span class="n">clobber</span> <span class="o">--</span><span class="n">dr19</span>
<span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">obs</span> <span class="n">lco</span> <span class="o">--</span><span class="n">nodes</span> <span class="mi">2</span> <span class="o">--</span><span class="n">custom</span> <span class="n">allepoch_lco</span> <span class="o">--</span><span class="n">allsky</span> <span class="o">--</span><span class="mi">1</span><span class="n">dpost</span>
<span class="n">uubatchpbs</span> <span class="o">--</span><span class="n">sdssv</span> <span class="o">--</span><span class="n">obs</span> <span class="n">apo</span> <span class="o">--</span><span class="n">nodes</span> <span class="mi">1</span> <span class="o">--</span><span class="n">custom</span> <span class="n">allepoch</span> <span class="o">--</span><span class="n">allsky</span> <span class="o">--</span><span class="mi">1</span><span class="n">dpost</span>
</pre></div>
</div>
</section>
<section id="build-custom-coadd-summary-files">
<h3>Build Custom Coadd Summary Files<a class="headerlink" href="#build-custom-coadd-summary-files" title="Permalink to this heading">#</a></h3>
<p>The final step of the epoch pipeline is to take the individual Custom Coadded MJD summary files and merge them in to final summary files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slurm_pySummary</span> <span class="o">--</span><span class="n">module</span> <span class="n">bhm</span><span class="o">/</span><span class="n">v6_2_0beta</span> <span class="o">--</span><span class="n">full</span> <span class="o">--</span><span class="n">custom</span> <span class="n">allepoch</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span>
<span class="n">slurm_pySummary</span> <span class="o">--</span><span class="n">module</span> <span class="n">bhm</span><span class="o">/</span><span class="n">v6_2_0beta</span> <span class="o">--</span><span class="n">full</span> <span class="o">--</span><span class="n">custom</span> <span class="n">allepoch_lco</span> <span class="o">--</span><span class="n">walltime</span> <span class="s2">&quot;335:00:00&quot;</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="daily.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Running a BOSS DRP Daily Run</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="intro.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">IDLspec2D: The SDSS BOSS Data Reduction Pipeline</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, SDSS Collaboration
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Running a BOSS DRP Catchup Run</a><ul>
<li><a class="reference internal" href="#daily-coadds">Daily Coadds</a><ul>
<li><a class="reference internal" href="#build-the-spplan-files">build the spplan files</a></li>
<li><a class="reference internal" href="#build-fibermap-files-optional-but-recommended">build fibermap files (<em>optional but recommended</em>)</a></li>
<li><a class="reference internal" href="#build-sptracetab-files">build spTraceTab files</a></li>
<li><a class="reference internal" href="#run-daily-coadd">Run Daily Coadd</a></li>
<li><a class="reference internal" href="#build-daily-summary-files">Build Daily Summary Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#field-epoch-coadds">Field Epoch Coadds</a><ul>
<li><a class="reference internal" href="#id1">build the spplan files</a></li>
<li><a class="reference internal" href="#run-the-epoch-coadd">Run the epoch Coadd</a></li>
<li><a class="reference internal" href="#build-epoch-summary-files">Build Epoch Summary Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-coadds-eg-allepoch">Custom Coadds (eg. “allepoch”)</a><ul>
<li><a class="reference internal" href="#managing-the-schema">Managing the schema</a></li>
<li><a class="reference internal" href="#id2">build the spplan files</a></li>
<li><a class="reference internal" href="#build-the-spfullsky-files">Build the spFullSky files</a></li>
<li><a class="reference internal" href="#run-1d-analysis-and-post-processing-steps">run 1d analysis and post processing steps</a></li>
<li><a class="reference internal" href="#build-custom-coadd-summary-files">Build Custom Coadd Summary Files</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=aaf0a054"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=df1a032d"></script>
    </body>
</html>